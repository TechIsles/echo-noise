# è¯´è¯´ç¬”è®°

### Ech0 - Noise

![é¢„è§ˆ](https://s2.loli.net/2025/03/25/7gyEspef1ZhOtrH.png)

## ä»‹ç»

è¿™æ˜¯åŸºäºEch0åŸºæœ¬æ¡†æ¶çš„äºŒæ¬¡å¼€å‘ã€é­”æ”¹åŠå®Œå–„ï¼Œç±»ä¼¼æœ‹å‹åœˆæ ·å¼é£æ ¼ï¼Œæ”¯æŒåå°é…ç½®ä¿®æ”¹å¦‚èƒŒæ™¯å›¾ã€ä¸ªæ€§ç­¾åç­‰ï¼Œæ”¯æŒapi è·å–å†…å®¹ã€æ›´æ–°æ“ä½œç­‰ï¼Œæ”¯æŒå¯¹bç«™è§†é¢‘ã€ç½‘æ˜“äº‘éŸ³ä¹ã€youtubeç­‰çš„è§£ææ·»åŠ ã€æ”¯æŒä¸€é”®å¤åˆ¶ï¼Œä¸€é”®ç”Ÿæˆå†…å®¹å›¾ç‰‡ã€æ”¯æŒhttp postå‘é€å†…å®¹åˆ°å¹³å°ï¼Œæ”¯æŒå¯¹æ¥webhookã€telegramã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦çš„ä¸€é”®æ¨é€ï¼Œæ”¯æŒå†…å®¹çƒ­åŠ›å›¾ç»„ä»¶ç­‰ä¸ªæ€§åŒ–ç»„ä»¶ï¼Œå®ƒå®Œå…¨å±äºä¸ªäººçš„è‡ªå®šåŒ–ä½¿ç”¨ï¼Œä¼šåŠ å…¥å®šåˆ¶åŒ–çš„ä¸€äº›åŠŸèƒ½ï¼Œç”±äºä»£ç å·²é‡æ„ï¼Œä¸åŒæ­¥äºåŸç‰ˆ

åŸç‰ˆä»‹ç»

Ech0 æ˜¯ä¸€æ¬¾ä¸“ä¸ºè½»é‡çº§åˆ†äº«è€Œè®¾è®¡çš„å¼€æºè‡ªæ‰˜ç®¡å¹³å°ï¼Œæ”¯æŒå¿«é€Ÿå‘å¸ƒä¸åˆ†äº«ä½ çš„æƒ³æ³•ã€æ–‡å­—ä¸é“¾æ¥ã€‚ç®€å•ç›´è§‚çš„æ“ä½œç•Œé¢ï¼Œè½»æ¾ç®¡ç†ä½ çš„å†…å®¹ï¼Œè®©åˆ†äº«å˜å¾—æ›´åŠ è‡ªç”±ï¼Œç¡®ä¿æ•°æ®å®Œå…¨æŒæ§ï¼Œéšæ—¶éšåœ°ä¸ä¸–ç•Œè¿æ¥ã€‚

åŸç‰ˆåœ°å€ï¼šhttps://github.com/lin-snow/Ech0

------



## æ•´ä½“æ”¹ç‰ˆä¼˜åŒ–

### ç¼–è¾‘å™¨éƒ¨åˆ†ï¼š

1. è‡ªé€‚åº”é«˜åº¦å’Œæ‹–æ‹½è°ƒæ•´åŠŸèƒ½
2. æ‰©å±•çš„å·¥å…·æ åŠŸèƒ½
3. å®Œæ•´çš„å“åº”å¼æ”¯æŒ
4. å¹³æ»‘çš„è¿‡æ¸¡åŠ¨ç”»æ•ˆæœ
5. ä¼˜åŒ–çš„é—´è·å’Œå­—ä½“è®¾ç½®
6. mdæ ¼å¼å›¾ç‰‡å³æ—¶é¢„è§ˆ
7. æ·»åŠ å®šåˆ¶åŒ–çš„ç»„ä»¶

## ä¸»é¡µéƒ¨åˆ†ï¼š

1. è°ƒæ•´é¡µé¢å†…å®¹è‡ªé€‚åº”é«˜åº¦å’Œå®½åº¦
2. æ·»åŠ éšæœºèƒŒæ™¯å›¾çš„å±•ç¤ºå¹¶å¸¦æœ‰æ¨¡ç³Šæ•ˆæœ
3. å¢åŠ md æ ¼å¼ä¸‹å¯¹ç½‘æ˜“äº‘éŸ³ä¹ã€å“”å“©å“”å“©è§†é¢‘ã€youtubeã€qq éŸ³ä¹çš„è§£ææ¸²æŸ“
4. è°ƒæ•´ä¿¡æ¯æ¡ç›®çš„èƒŒæ™¯ui åŠæ˜¾ç¤ºå°ºå¯¸çš„ä¼˜åŒ–
5. è°ƒæ•´uiåŠåŠ è½½å“åº”é¡µé¢çš„æ•´ä½“æ˜¾ç¤ºæ•ˆæœ
6. æ·»åŠ æœ‹å‹åœˆæ ·å¼ä¸»å›¾banner,å¹¶å’ŒèƒŒæ™¯å›¾ä½¿ç”¨ç›¸åŒ
7. æ‰€æœ‰é“¾æ¥éƒ½å¯é€šè¿‡æ–°æ ‡ç­¾é¡µæ‰“å¼€
8. é•¿å†…å®¹çš„æŠ˜å å±•å¼€å¤„ç†
9. å®Œå–„çš„äºŒæ¬¡ç¼–è¾‘åŠé¢„è§ˆä¿å­˜
10. ä¸€é”®å¤åˆ¶åŠç”Ÿæˆå†…å®¹å›¾ç‰‡çš„åŠŸèƒ½åŒ–ç»„ä»¶
11. å¢åŠ æ ‡ç­¾ç³»ç»Ÿè·¯ç”±åŠç»„ä»¶

## ä»£ç éƒ¨åˆ†

1. è°ƒæ•´jwkéªŒè¯ä¸ºsessionæ–¹å¼ï¼ŒåŒæ—¶è°ƒæ•´tokençš„éªŒè¯æœºåˆ¶
2. è°ƒæ•´ä¼˜åŒ–æ•°æ®åº“çš„è¿ç§»åŠè¿æ¥å¤„ç†
3. å¢åŠ ä¸åŒçš„è·¯ç”±åŠè°ƒæ•´æ§åˆ¶å™¨
4. å¢åŠ é¢å¤–çš„å¤–æŒ‚æ’ä»¶æ–‡ä»¶
5. å¢åŠ å®šæœŸæ¸…ç†ç¼“å­˜

<details>
<summary><h2>âœ… æ›´æ–°çŠ¶å†µã€ç‚¹å‡»æŸ¥çœ‹ã€‘</h2></summary>


- å¢åŠ æ¨é€æ¸ é“ï¼ˆwebhookã€tgã€ä¼ä¸šå¾®ä¿¡ã€é£ä¹¦ï¼‰åŠå®ç°ä¸€é”®æ¨é€-ç¼–è¾‘å™¨ç»„ä»¶

- æ·»åŠ æ”¯æŒåŒæ ¼å¼è®¤è¯

  - Authorization: Bearer your_token_here
  - Authorization: your_token_here

   


- å¢åŠ äº†æ ‡ç­¾ç³»ç»Ÿå’Œå›¾ç‰‡api è·¯ç”±

- å¢åŠ åå°ç³»ç»Ÿç‰ˆæœ¬æ£€æµ‹

- å¢åŠ è¿œç¨‹æ•°æ®åº“PostgreSQLã€MySQLçš„è¿æ¥æ”¯æŒï¼Œé»˜è®¤SQLite

- é™¤äº†session è®¤è¯å¤–å¢åŠ Tokenè®¤è¯ï¼Œåå°å¯è®¾ç½®æ›´æ”¹ï¼Œæ–¹ä¾¿ä½¿ç”¨apiå‘å¸ƒä¿¡æ¯

  ![1743847126537](https://s2.loli.net/2025/04/05/QqLEC1HUw2J9XO8.png)

  

- å¢åŠ æœç´¢åŠŸèƒ½ç»„ä»¶

  ![1743816024503](https://s2.loli.net/2025/04/05/wcJSRFktmrxTpui.png)

- å¢åŠ å†…å®¹å‘å¸ƒæ—¥å†-çƒ­åŠ›å›¾ç»„ä»¶ï¼Œé»˜è®¤ä¸æ˜¾ç¤ºï¼Œç‚¹å‡»æ—¥å†å›¾æ ‡åæ˜¾ç¤º

  ![1743765992985_å‰¯æœ¬](https://s2.loli.net/2025/04/04/Jf48HmYjvCk1sVU.png)

- æ·»åŠ æ¯æ¡ç¬”è®°æ¡ç›®çš„è¯„è®ºåŠŸèƒ½ï¼ˆå±äºå¤–æŒ‚è¯„è®ºï¼Œå› ä¸ºå®¹æ˜“é›†æˆå’Œçœäº‹ï¼‰

  ![1742962169845](https://s2.loli.net/2025/03/26/kKJsw51PzcUdyQ6.png)

- å¢åŠ mdæ ¼å¼å›¾ç‰‡ä¸‹Fancyboxç¯ç®±æ¨¡å¼ï¼ˆåŒ…æ‹¬ç¼–è¾‘å™¨åŠç¬”è®°åˆ—è¡¨ä¸­ï¼‰ï¼Œå¼•å…¥medium-zoomã€fancyboxç»„ä»¶

- å¢åŠ ç¬”è®°å†…å®¹æ˜¾ç¤ºé«˜åº¦çš„æ˜¾ç¤ºï¼Œè¶…è¿‡700pxæ—¶ä¼šæŠ˜å æ˜¾ç¤º

- å†…å®¹æ¡ç›®ä¸Šæ–¹æ·»åŠ ä¸€é”®å¤åˆ¶åŠŸèƒ½

- å¢åŠ ç¬”è®°å†…å®¹äºŒæ¬¡ç¼–è¾‘ä¿®æ”¹åŠŸèƒ½ï¼ˆç®¡ç†å‘˜æˆ–åŸå‘å¸ƒè€…æƒé™ï¼‰

  ![1743011515420](https://s2.loli.net/2025/03/27/ZtBbmGMqHw5RoFO.png)

- ä¼˜åŒ–ç¼–è¾‘å™¨é¢„è§ˆåŠä¿®æ”¹å†…å®¹çš„é¢„è§ˆæ ·å¼

- å¢åŠ ç”Ÿæˆå†…å®¹å¡ç‰‡çš„åŠŸèƒ½

  ![01.45.31](https://s2.loli.net/2025/03/27/vCKs1ZtPqO8n7jY.png)

- æ·»åŠ äº†ç¬”è®°å†…å®¹å‘å¸ƒè€…åç§°çš„æ˜¾ç¤ºï¼ˆæ—¶é—´çŠ¶æ€å³ä¾§ï¼‰

- ä¿®æ”¹åˆ é™¤é€»è¾‘ï¼Œå…è®¸å‘å¸ƒè€…åˆ é™¤è‡ªå·±çš„ä¿¡æ¯

- å°†ç®¡ç†å‘˜åˆ¤æ–­é€»è¾‘ç§»åˆ°äº† services å±‚

- è°ƒæ•´åå°ç•Œé¢

  ![C8Yn4VJ96PgrioX](https://s2.loli.net/2025/03/31/C8Yn4VJ96PgrioX.png)

- ä¼˜åŒ–è½½å…¥é€Ÿåº¦åŠè°ƒæ•´èƒŒæ™¯å›¾ç‰‡è½½å…¥é€»è¾‘

- ä¼˜åŒ–ç”Ÿæˆå¡ç‰‡å›¾ç‰‡æ•ˆæœ

- å¢åŠ åå°æ•°æ®é…ç½®ï¼ŒåŒ…æ‹¬è¯„è®ºã€åº•éƒ¨é¡µè„šã€rssè®¾ç½®ç­‰

  ![iLTP9tARVoaj3cv](https://s2.loli.net/2025/04/01/iLTP9tARVoaj3cv.png)

- å¢åŠ æ•°æ®åº“æ–‡ä»¶çš„å¤‡ä»½ã€ä¸Šä¼ 

  ![ehS1BxwbUKyD2Vm](https://s2.loli.net/2025/04/01/ehS1BxwbUKyD2Vm.png)

  

  </details>

  

------

## å®‰è£…éƒ¨ç½²

> ğŸ’¡ éƒ¨ç½²å®Œæˆåè®¿é—® ip:1314 å³å¯ä½¿ç”¨
> 

## [dockeréƒ¨ç½²](https://hub.docker.com/repository/docker/noise233/echo-noise)

ä¸€é”®éƒ¨ç½²

```
docker run -d \
  --name Ech0-Noise \
  --platform linux/amd64 \
  -p 1314:1314 \
  -v /opt/data/noise.db:/app/data/noise.db \
  noise233/echo-noise
```

`/opt/data/noise.db`æ˜¯ä½ æœ¬åœ°çš„åŸæœ‰æ•°æ®åº“æ–‡ä»¶ï¼Œå¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥å»æ‰è¿™ä¸ªæŒ‚è½½å‘½ä»¤ï¼Œå®ƒä¹Ÿä¼šè‡ªåŠ¨åˆ›å»º

é»˜è®¤ç”¨æˆ·åï¼šadmin

é»˜è®¤ç”¨æˆ·å¯†ç ï¼šadmin

### docker-componseæ„å»ºéƒ¨ç½²

åœ¨è¯¥ç›®å½•ä¸‹æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å¯åŠ¨æœåŠ¡ï¼ˆä¸ä¿®æ”¹ç¯å¢ƒå˜é‡æ—¶é»˜è®¤ä½¿ç”¨æœ¬åœ°æ•°æ®åº“.db æ–‡ä»¶ï¼‰ï¼š

```shell
docker-compose up -d
```

# å¼€å‘

ä¾èµ–ç¯å¢ƒ
åç«¯ï¼š `Go 1.24.1+`
å‰ç«¯ï¼š `NodeJS v22.13.0,NPM`

å¯åŠ¨
åœ¨æ ¹ç›®å½•ä¸‹ï¼š

åç«¯ï¼š

```
go run cmd/server/main.go
```

å‰ç«¯ï¼š å°†`.env`æ–‡ä»¶ä¸­çš„prodé‚£ä¸€è¡Œæ³¨é‡Šæ‰ï¼Œç„¶åä¿ç•™devå³å¯

```
cd web # è¿›å…¥å‰ç«¯ç›®å½•

npm run dev
```

## æ•°æ®åº“è¿æ¥

æœ¬åœ°æ•°æ®åº“ç›´æ¥dockeréƒ¨ç½²å³å¯

è¿œç¨‹æ•°æ®åº“æœåŠ¡åˆ™å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡è¿æ¥

è¿æ¥è¿œç¨‹ PostgreSQLï¼š
```bash
docker run -d \
  --name Ech0-Noise \
  --platform linux/amd64 \
  -p 1314:1314 \
  -e DB_TYPE=postgres \
  -e DB_HOST=your.postgres.host \
  -e DB_PORT=5432 \
  -e DB_USER=your_username \
  -e DB_PASSWORD=your_password \
  -e DB_NAME=noise \
  -v /opt/data/images:/app/data/images \
  noise233/echo-noise
```

è¿æ¥è¿œç¨‹ MySQLï¼š
```bash
docker run -d \
  --name Ech0-Noise \
  --platform linux/amd64 \
  -p 1314:1314 \
  -e DB_TYPE=mysql \
  -e DB_HOST=your.mysql.host \
  -e DB_PORT=3306 \
  -e DB_USER=your_username \
  -e DB_PASSWORD=your_password \
  -e DB_NAME=noise \
  -v /opt/data/images:/app/data/images \
  noise233/echo-noise
```

æ³¨æ„äº‹é¡¹ï¼š
1. ç¡®ä¿è¿œç¨‹æ•°æ®åº“å…è®¸å¤–éƒ¨è¿æ¥
2. æ£€æŸ¥é˜²ç«å¢™è®¾ç½®
3. ä½¿ç”¨æ­£ç¡®çš„æ•°æ®åº“è¿æ¥ä¿¡æ¯
4. å»ºè®®ä½¿ç”¨åŠ å¯†è¿æ¥
5. æ³¨æ„æ•°æ®åº“çš„å­—ç¬¦é›†è®¾ç½®

å¯¹äº [Neon PostgreSQL](https://console.neon.tech/) è¿™æ ·çš„äº‘æ•°æ®åº“æœåŠ¡ï¼Œéœ€è¦ä½¿ç”¨ç‰¹å®šçš„è¿æ¥å‚æ•°ã€‚ä»¥ä¸‹æ˜¯è¿æ¥å‘½ä»¤ï¼š

```bash
docker run -d \
  --name Ech0-Noise \
  --platform linux/amd64 \
  -p 1314:1314 \
  -e DB_TYPE=postgres \
  -e DB_HOST=your.host \
  -e DB_PORT=5432 \
  -e DB_USER=user_owner \
  -e DB_PASSWORD=password \
  -e DB_NAME=yourname \
  -e DB_SSL_MODE=require \
  -v /opt/data/images:/app/data/images \
  noise233/echo-noise
```

æ³¨æ„äº‹é¡¹ï¼š
1. æ·»åŠ äº† `DB_SSL_MODE=require` ç¯å¢ƒå˜é‡ï¼Œå› ä¸º Neon è¦æ±‚ SSL è¿æ¥
2. ä½¿ç”¨äº†è¿æ¥ URL ä¸­æä¾›çš„ä¸»æœºåã€ç”¨æˆ·åã€å¯†ç å’Œæ•°æ®åº“å
4. ä¿æŒå›¾ç‰‡ç›®å½•çš„æŒ‚è½½

## æ•°æ®çš„å¤‡ä»½æ¢å¤

å¯¹äºæ‰€æœ‰æ•°æ®åº“ç±»å‹ï¼ˆSQLite/PostgreSQL/MySQLï¼‰ï¼Œç‚¹å‡»åå°æ•°æ®åº“ä¸‹è½½æŒ‰é’®åï¼Œéƒ½ä¼šå…ˆå¤‡ä»½æ•°æ®åº“æ–‡ä»¶

- ç„¶åä¼šå°†åŒ…å«æ•°æ®åº“å¤‡ä»½å’Œå›¾ç‰‡æ‰“åŒ…æˆ zip æ–‡ä»¶
- zip æ–‡ä»¶ä¸­ä¼šåŒ…å«ï¼š
  - æ•°æ®åº“å¤‡ä»½æ–‡ä»¶ï¼ˆ.db/.sqlï¼‰
  - images ç›®å½•ä¸‹çš„æ‰€æœ‰å›¾ç‰‡

```plaintext
å¤‡ä»½è¿‡ç¨‹ï¼š
æœ¬åœ° -> æ‰§è¡Œå¤‡ä»½å‘½ä»¤ -> ç”Ÿæˆå¤‡ä»½æ–‡ä»¶ -> æ‰“åŒ…ä¸‹è½½

æ¢å¤è¿‡ç¨‹ï¼š
ä¸Šä¼ å¤‡ä»½æ–‡ä»¶ -> è§£å‹ç¼© -> æ‰§è¡Œæ¢å¤å‘½ä»¤ -> å¯¼å…¥åˆ°äº‘æ•°æ®åº“
```

æ¢å¤è¦æ±‚ï¼š

- SQLiteæœ¬åœ°æ•°æ®åº“å¤‡ä»½å’Œä¸Šä¼ æ—¶é»˜è®¤ä½¿ç”¨çš„æ–‡ä»¶åæ˜¯ä¸€è‡´ä¸ºnoise.db
- éæœ¬åœ°æ•°æ®åº“PostgreSQL/MySQLè¯·å‘½åä¸ºdatabase.sqlå¹¶æ”¾å…¥database.zipæ¥æ¢å¤
- å¦‚æœå¤‡ä»½æ—¶zipä¸­æœ‰å›¾ç‰‡æ–‡ä»¶å¤¹åˆ™åŒæ—¶ä¼šæ¢å¤ images ç›®å½•ä¸‹çš„æ‰€æœ‰å›¾ç‰‡

âš ï¸ ï¼šå› PostgreSQL/MySQLäº‘æœåŠ¡ä¼šæœ‰SSLè¿æ¥ã€å…¼å®¹ç‰ˆæœ¬å·ã€æ•°æ®è¡¨æ ¼å¼ç­‰è¦æ±‚ï¼Œåå°ä¸€é”®å¤‡ä»½æ¢å¤ä¸ä¸€å®šèƒ½æ»¡è¶³ä½ éœ€è¦è¿æ¥çš„è¿œç¨‹æ•°æ®åº“ï¼Œè¯·å°½é‡å‰å¾€æœåŠ¡å•†å¤„ä¸‹è½½å¤‡ä»½

## APIæŒ‡å—ğŸ§­

*å› apiä¼—å¤š...éœ€å¾…æ›´æ–°å®Œå–„...*

ï¼ˆè·å–ä¿¡æ¯æ˜¯get,å‘å¸ƒæ˜¯postï¼‰

å…ˆåˆ°åå°è·å–api token,ç„¶åå¯ä»¥å‚è€ƒä¸‹é¢çš„å‘½ä»¤è¿è¡Œæˆ–ä½¿ç”¨å…¶å®ƒæœåŠ¡ï¼ˆè®°å¾—å°†https://your.localhost.com æ›´æ”¹ä¸ºä½ è‡ªå·±çš„æœåŠ¡åœ°å€ï¼‰

![1743847126537](https://s2.loli.net/2025/04/05/QqLEC1HUw2J9XO8.png)

```
# å‘é€çº¯æ–‡æœ¬ä¿¡æ¯
curl -X POST 'https://your.localhost.com/api/token/messages' \
-H 'Content-Type: application/json' \
-H 'Authorization: Bearer c721249bd66e1133fba430ea9e3c32f1' \
-d '{
  "content": "æµ‹è¯•ä¿¡æ¯",
  "type": "text"
}'
```

```
# æ–¹å¼1ï¼šä½¿ç”¨ Markdown è¯­æ³•å‘é€æ–‡æœ¬
curl -X POST 'https://your.localhost.com/api/token/messages' \
-H 'Content-Type: application/json' \
-H 'Authorization: c721249bd66e1133fba430ea9e3c32f1' \
-d '{
  "content": "# æ ‡é¢˜\nè¿™æ˜¯ä¸€æ®µæ–‡å­—\n![å›¾ç‰‡æè¿°](https://example.com/image.jpg)",
  "type": "text"
}'

# æ–¹å¼2ï¼šä½¿ç”¨ type: image å‘é€å›¾ç‰‡æ¶ˆæ¯
curl -X POST 'https://your.localhost.com/api/token/messages' \
-H 'Content-Type: application/json' \
-H 'Authorization: c721249bd66e1133fba430ea9e3c32f1' \
-d '{
  "content": "å›¾ç‰‡æè¿°æ–‡å­—",
  "type": "image",
  "image": "https://example.com/image.jpg"
}'
```

å¦‚æœä½ æƒ³ä½¿ç”¨session è®¤è¯æ–¹å¼

```
curl -v -X POST 'https://your.localhost.com/api/messages' \
-H 'Content-Type: application/json' \
--cookie "your_session_cookie" \
-d '{
  "content": "æµ‹è¯•ä¿¡æ¯",
  "type": "text"
}'
```

å¯¹äºå›¾æ–‡æ··åˆæ¶ˆæ¯ï¼Œå¯ä»¥è¿™æ ·å‘é€ï¼š

```bash
curl -X POST 'https://your.localhost.com/api/token/messages' \
-H 'Content-Type: application/json' \
-H 'Authorization: c721249bd66e1133fba430ea9e3c32f1' \
-d '{
  "content": "# è¿™æ˜¯æ ‡é¢˜\n\nè¿™æ˜¯ä¸€æ®µæ–‡å­—è¯´æ˜\n\n![å›¾ç‰‡æè¿°](https://example.com/image.jpg)\n\nç»§ç»­å†™æ–‡å­—å†…å®¹",
  "type": "text"
}'
```

```
æˆ–è€…ä½¿ç”¨ multipart ç±»å‹ï¼š

curl -X POST 'https://your.localhost.com/api/token/messages' \
-H 'Content-Type: application/json' \
-H 'Authorization: c721249bd66e1133fba430ea9e3c32f1' \
-d '{
  "content": "# è¿™æ˜¯æ ‡é¢˜\n\nè¿™æ˜¯ä¸€æ®µæ–‡å­—è¯´æ˜",
  "type": "multipart",
  "image": "https://example.com/image.jpg"
}
```

<details>
<summary><h2>âœ… APIè¯¦æƒ…ã€ç‚¹å‡»æŸ¥çœ‹ã€‘</h2></summary>

# API æ–‡æ¡£ï¼ˆå¾…å¢åŠ ï¼‰

## å…¬å…±æ¥å£

### 1. è·å–å‰ç«¯é…ç½®
- **è·¯å¾„**: `/api/frontend/config`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–å‰ç«¯é…ç½®ä¿¡æ¯
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/frontend/config
```

### 2. ç”¨æˆ·ç™»å½•
- **è·¯å¾„**: `/api/login`
- **æ–¹æ³•**: POST
- **æè¿°**: ç”¨æˆ·ç™»å½•æ¥å£
- **è¯·æ±‚ä½“**:
```json
{
    "username": "admin",
    "password": "password"
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/login \
     -H "Content-Type: application/json" \
     -d '{"username":"admin","password":"password"}'
```

### 3. ç”¨æˆ·æ³¨å†Œ
- **è·¯å¾„**: `/api/register`
- **æ–¹æ³•**: POST
- **æè¿°**: ç”¨æˆ·æ³¨å†Œæ¥å£
- **è¯·æ±‚ä½“**:
```json
{
    "username": "newuser",
    "password": "password",
    "email": "user@example.com"
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/register \
     -H "Content-Type: application/json" \
     -d '{"username":"newuser","password":"password","email":"user@example.com"}'
```

### 4. è·å–ç³»ç»ŸçŠ¶æ€
- **è·¯å¾„**: `/api/status`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/status
```

### 5. æ¶ˆæ¯ç›¸å…³å…¬å…±æ¥å£

#### 5.1 è·å–æ‰€æœ‰æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–æ‰€æœ‰å…¬å¼€æ¶ˆæ¯
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/messages
```

#### 5.2 è·å–å•æ¡æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages/:id`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–æŒ‡å®šIDçš„æ¶ˆæ¯
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/messages/1
```

#### 5.3 åˆ†é¡µè·å–æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages/page`
- **æ–¹æ³•**: POSTæˆ–GET
- **æè¿°**: åˆ†é¡µè·å–æ¶ˆæ¯åˆ—è¡¨
- **è¯·æ±‚ä½“**:
```json
{
    "page": 1,
    "pageSize": 10
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/messages/page \
     -H "Content-Type: application/json" \
     -d '{"page":1,"pageSize":10}'
```

#### 5.4 è·å–æ¶ˆæ¯æ—¥å†æ•°æ®
- **è·¯å¾„**: `/api/messages/calendar`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–æ¶ˆæ¯å‘å¸ƒçƒ­åŠ›å›¾æ•°æ®
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/messages/calendar
```

#### 5.5 æœç´¢æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages/search`
- **æ–¹æ³•**: GET
- **å‚æ•°**: 
  - keyword: æœç´¢å…³é”®è¯
  - page: é¡µç 
  - pageSize: æ¯é¡µæ•°é‡
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl "http://localhost:8080/api/messages/search?keyword=æµ‹è¯•&page=1&pageSize=10"
```

### 6. RSS ç›¸å…³æ¥å£

#### 6.1 è·å– RSS è®¢é˜…
- **è·¯å¾„**: `/rss`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å– RSS è®¢é˜…å†…å®¹
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:1314/rss
```

## éœ€è¦è®¤è¯çš„æ¥å£

### 1. æ¶ˆæ¯æ“ä½œæ¥å£

#### 1.1 å‘å¸ƒæ¶ˆæ¯
- **è·¯å¾„**: `/api/messages`
- **æ–¹æ³•**: POST
- **æè¿°**: å‘å¸ƒæ–°æ¶ˆæ¯
- **è¯·æ±‚ä½“**:
```json
{
    "content": "æ¶ˆæ¯å†…å®¹",
    "private": false,
    "imageURL": ""
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/messages \
     -H "Content-Type: application/json" \
     -H "Cookie: session=xxx" \
     -d '{"content":"æµ‹è¯•æ¶ˆæ¯","private":false}'
```

#### 1.2 æ›´æ–°æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages/:id`
- **æ–¹æ³•**: PUT
- **æè¿°**: æ›´æ–°æŒ‡å®šæ¶ˆæ¯
- **è¯·æ±‚ä½“**:
```json
{
    "content": "æ›´æ–°åçš„å†…å®¹"
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X PUT http://localhost:8080/api/messages/1 \
     -H "Content-Type: application/json" \
     -H "Cookie: session=xxx" \
     -d '{"content":"æ›´æ–°åçš„å†…å®¹"}'
```

#### 1.3 åˆ é™¤æ¶ˆæ¯
- **è·¯å¾„**: `/api/messages/:id`
- **æ–¹æ³•**: DELETE
- **æè¿°**: åˆ é™¤æŒ‡å®šæ¶ˆæ¯
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X DELETE http://localhost:8080/api/messages/1 \
     -H "Cookie: session=xxx"
```

### 2. ç”¨æˆ·ç›¸å…³æ¥å£

#### 2.1 è·å–ç”¨æˆ·ä¿¡æ¯
- **è·¯å¾„**: `/api/user`
- **æ–¹æ³•**: GET
- **æè¿°**: è·å–å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/user \
     -H "Cookie: session=xxx"
```

#### 2.2 ä¿®æ”¹å¯†ç 
- **è·¯å¾„**: `/api/user/change_password`
- **æ–¹æ³•**: PUT
- **è¯·æ±‚ä½“**:
```json
{
    "oldPassword": "æ—§å¯†ç ",
    "newPassword": "æ–°å¯†ç "
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X PUT http://localhost:8080/api/user/change_password \
     -H "Content-Type: application/json" \
     -H "Cookie: session=xxx" \
     -d '{"oldPassword":"old","newPassword":"new"}'
```

#### 2.3 æ›´æ–°ç”¨æˆ·ä¿¡æ¯
- **è·¯å¾„**: `/api/user/update`
- **æ–¹æ³•**: PUT
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X PUT http://localhost:8080/api/user/update \
     -H "Content-Type: application/json" \
     -H "Cookie: session=xxx" \
     -d '{"username":"newname"}'
```

#### 2.4 é€€å‡ºç™»å½•
- **è·¯å¾„**: `/api/user/logout`
- **æ–¹æ³•**: POST
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/user/logout \
     -H "Cookie: session=xxx"
```

### 3. Token ç›¸å…³æ¥å£

#### 3.1 è·å–ç”¨æˆ· Token
- **è·¯å¾„**: `/api/user/token`
- **æ–¹æ³•**: GET
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/user/token \
     -H "Cookie: session=xxx"
```

#### 3.2 é‡æ–°ç”Ÿæˆ Token
- **è·¯å¾„**: `/api/user/token/regenerate`
- **æ–¹æ³•**: POST
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/user/token/regenerate \
     -H "Cookie: session=xxx"
```

### 4. ç³»ç»Ÿè®¾ç½®æ¥å£

#### 4.1 æ›´æ–°ç³»ç»Ÿè®¾ç½®
- **è·¯å¾„**: `/api/settings`
- **æ–¹æ³•**: PUT
- **è¯·æ±‚ä½“**:
```json
{
    "allowRegistration": true,
    "frontendSettings": {
        "siteTitle": "ç½‘ç«™æ ‡é¢˜",
        "subtitleText": "å‰¯æ ‡é¢˜",
        "avatarURL": "å¤´åƒURL",
        "username": "æ˜¾ç¤ºç”¨æˆ·å",
        "description": "æè¿°",
        "backgrounds": ["èƒŒæ™¯å›¾URL"],
        "cardFooterTitle": "é¡µè„šæ ‡é¢˜",
        "cardFooterLink": "é¡µè„šé“¾æ¥",
        "pageFooterHTML": "é¡µè„šHTML",
        "rssTitle": "RSSæ ‡é¢˜",
        "rssDescription": "RSSæè¿°",
        "rssAuthorName": "RSSä½œè€…",
        "rssFaviconURL": "RSSå›¾æ ‡URL",
        "walineServerURL": "è¯„è®ºç³»ç»ŸURL"
    }
}
```
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X PUT http://localhost:8080/api/settings \
     -H "Content-Type: application/json" \
     -H "Cookie: session=xxx" \
     -d '{"allowRegistration":true,"frontendSettings":{"siteTitle":"æˆ‘çš„ç½‘ç«™"}}'
```

### 5. å¤‡ä»½ç›¸å…³æ¥å£

#### 5.1 ä¸‹è½½å¤‡ä»½
- **è·¯å¾„**: `/api/backup/download`
- **æ–¹æ³•**: GET
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl http://localhost:8080/api/backup/download \
     -H "Cookie: session=xxx" \
     --output backup.sql
```

#### 5.2 æ¢å¤å¤‡ä»½
- **è·¯å¾„**: `/api/backup/restore`
- **æ–¹æ³•**: POST
- **æè¿°**: ä»å¤‡ä»½æ–‡ä»¶æ¢å¤æ•°æ®
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/backup/restore \
     -H "Cookie: session=xxx" \
     -F "file=@backup.sql"
```

### 6. å›¾ç‰‡ä¸Šä¼ æ¥å£

#### 6.1 ä¸Šä¼ å›¾ç‰‡
- **è·¯å¾„**: `/api/images/upload`
- **æ–¹æ³•**: POST
- **æè¿°**: ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶
- **ç¤ºä¾‹è¯·æ±‚**:
```bash
curl -X POST http://localhost:8080/api/images/upload \
     -H "Cookie: session=xxx" \
     -F "file=@image.jpg"
```

### 7.æ¨é€é…ç½®è·¯ç”±ä½¿ç”¨è¯´æ˜

#### è·å–æ¨é€é…ç½®

- **è·¯å¾„**: `/api/notify/config`  
- **æ–¹æ³•**: GET  
- **æè¿°**: è·å–å½“å‰æ¨é€æ¸ é“é…ç½®  
- **ç¤ºä¾‹è¯·æ±‚**:

```bash
curl -X GET http://localhost:8080/api/notify/config \
     -H "Cookie: session=xxx"
```

#### ä¿å­˜æ¨é€é…ç½®

- **è·¯å¾„**: `/api/notify/config`  
- **æ–¹æ³•**: PUT  
- **æè¿°**: æ›´æ–°æ¨é€æ¸ é“é…ç½®  
- **è¯·æ±‚ä½“ç¤ºä¾‹**:

```json
{
  "webhookEnabled": true,
  "webhookURL": "https://webhook.example.com",
  "telegramEnabled": true,
  "telegramToken": "bot123:ABC",
  "telegramChatID": "-100123456",
  "weworkEnabled": false,
  "weworkKey": "",
  "feishuEnabled": true,
  "feishuWebhook": "https://open.feishu.cn/xxx",
  "feishuSecret": "signature_key"
}
```

- **ç¤ºä¾‹è¯·æ±‚**:

```bash
curl -X PUT http://localhost:8080/api/notify/config \
     -H "Cookie: session=xxx" \
     -H "Content-Type: application/json" \
     -d '{
           "webhookEnabled": true,
           "webhookURL": "https://webhook.example.com"
         }'
```

#### æµ‹è¯•æ¨é€

- **è·¯å¾„**: `/api/notify/test`  
- **æ–¹æ³•**: POST  
- **æè¿°**: æµ‹è¯•æŒ‡å®šæ¨é€æ¸ é“  
- **è¯·æ±‚ä½“ç¤ºä¾‹**:

```json
{
  "type": "telegram"
}
```

- **ç¤ºä¾‹è¯·æ±‚**:

```bash
curl -X POST http://localhost:8080/api/notify/test \
     -H "Cookie: session=xxx" \
     -H "Content-Type: application/json" \
     -d '{"type": "telegram"}'
```

#### å‘é€æ¨é€

- **è·¯å¾„**: `/api/notify/send`  
- **æ–¹æ³•**: POST  
- **æè¿°**: æ‰‹åŠ¨è§¦å‘æ¨é€ï¼ˆéœ€å·²é…ç½®æ¨é€æ¸ é“ï¼‰  
- **è¯·æ±‚ä½“ç¤ºä¾‹**:

```json
{
  "content": "æµ‹è¯•æ¶ˆæ¯å†…å®¹",
  "images": ["https://example.com/image.jpg"],
  "format": "markdown"
}
```

- **ç¤ºä¾‹è¯·æ±‚**:

```bash
curl -X POST http://localhost:8080/api/notify/send \
     -H "Cookie: session=xxx" \
     -H "Content-Type: application/json" \
     -d '{"content": "ç´§æ€¥é€šçŸ¥ï¼"}'
```

æ³¨æ„äº‹é¡¹ï¼š
1. æ‰€æœ‰éœ€è¦è®¤è¯çš„æ¥å£éƒ½éœ€è¦åœ¨è¯·æ±‚å¤´ä¸­æºå¸¦æœ‰æ•ˆçš„ session cookie
2. éƒ¨åˆ†æ¥å£å¯èƒ½éœ€è¦ç®¡ç†å‘˜æƒé™
3. æ‰€æœ‰è¯·æ±‚ç¤ºä¾‹ä¸­çš„åŸŸåå’Œç«¯å£å·éœ€è¦æ ¹æ®å®é™…éƒ¨ç½²æƒ…å†µè°ƒæ•´
4. æ–‡ä»¶ä¸Šä¼ æ¥å£éœ€è¦ä½¿ç”¨ multipart/form-data æ ¼å¼
5. Token è®¤è¯æ¥å£å¯ä»¥ä½¿ç”¨ Token æ›¿ä»£ session è¿›è¡Œè®¤è¯

</details>

## å‘å¸ƒè¯´æ˜

ç›®å‰ä¼šæ„å»ºä¸¤ä¸ªç‰ˆæœ¬ï¼Œ

ç¨³å®šç‰ˆï¼šlatesté•œåƒ  

å®éªŒç‰ˆï¼šlasté•œåƒ

å¦‚æœä½ éœ€è¦æ„å»ºè‡ªå·±çš„é•œåƒå‘å¸ƒ-ç¤ºä¾‹ï¼š

```
docker buildx build --platform linux/amd64,linux/arm64 -t noise233/echo-noise:latest --push --no-cache .
```

# Memosæ•°æ®åº“è¿ç§»ç¤ºä¾‹

å…¶ä¸­ï¼Œä½ éœ€è¦è®¾ç½®è®¾ç½®æºæ•°æ®åº“å’Œç›®æ ‡æ•°æ®åº“çš„è·¯å¾„ï¼Œæºæ•°æ®åº“ä¸ºmemos_prod.dbï¼ˆmemosæ•°æ®ï¼‰ç›®æ ‡æ•°æ®åº“ä¸ºdatabase.dbï¼ˆæœ¬ç«™æ•°æ®åº“ï¼‰ï¼Œä½ è¿˜éœ€è¦ä¿®æ”¹æ„å»ºæ’å…¥çš„æ•°æ®ä¸­çš„ç”¨æˆ·åä¸ºä½ è‡ªå·±çš„ç”¨æˆ·åï¼Œåˆ†åˆ«è¿ç§»äº†åŸæ–‡æœ¬å†…å®¹ã€å‘å¸ƒæ—¶é—´ï¼Œå¯ä»¥åœ¨noise/memosè¿ç§»æ–‡ä»¶å¤¹ä¸­æ‰¾åˆ°è¯¥è„šæœ¬

ï¼Œè¿è¡Œpython3 main.pyå³å¯ï¼Œ

![1744202949838](https://s2.loli.net/2025/04/09/3yq8aMoOmJHIvlT.png)

è¿ç§»ç»“æŸåå°†ä½ çš„æ•°æ®åº“æ–‡ä»¶å’ŒåŸå›¾ç‰‡æ–‡ä»¶å¤¹ï¼ˆæœ‰çš„è¯ï¼‰æ‰“åŒ…ä¸ºzipæ ¼å¼ï¼Œè¿›å…¥ç«™ç‚¹åå°é€‰æ‹©æ¢å¤æ•°æ®ä¸Šä¼ å³å¯ã€‚

<details>
<summary><h2>âœ… Popclipå‘é€æ‰©å±•ã€ç‚¹å‡»æŸ¥çœ‹ã€‘</h2></summary>

é€‰ä¸­åè‡ªåŠ¨è¯†åˆ«å®‰è£…ï¼Œå‘é€æ—¶ä¼šè‡ªåŠ¨æ·»åŠ ä¸€ä¸ªpopclipå¼€å¤´çš„æ ‡ç­¾ï¼Œtokenå¯åœ¨åå°æ‰¾åˆ°

```
// #popclip extension for Send to Shuo
// name: è¯´è¯´ç¬”è®°
// icon: square filled è¯´
// language: javascript
// module: true
// entitlements: [network]
// options: [{
//   identifier: "siteUrl",
//   label: "æœåŠ¡ç«¯åœ°å€",
//   type: "string",
//   defaultValue: "https://note.noisework.cn",
//   description: "è¯·ç¡®ä¿åœ°å€æ­£ç¡®ï¼Œä¸è¦å¸¦æœ«å°¾æ–œæ "
// }, {
//   identifier: "token",
//   label: "API Token",
//   type: "string",
//   description: "ä»è®¾ç½®é¡µé¢è·å–æœ€æ–°Token"
// }]

async function sendToShuo(input, options) {
    try {
        // å‚æ•°é¢„å¤„ç†
        const siteUrl = (options.siteUrl || "").replace(/\/+$/g, "");
        const token = (options.token || "").trim();
        const content = (input.text || "").trim();
        
        // éªŒè¯å‚æ•°
        if (!/^https:\/\/[\w.-]+(:\d+)?$/.test(siteUrl)) {
            throw new Error("åœ°å€æ ¼å¼é”™è¯¯ï¼Œç¤ºä¾‹: https://note.noisework.cn");
        }
        if (!token) throw new Error("Tokenä¸èƒ½ä¸ºç©º");
        if (!content) throw new Error("é€‰ä¸­æ–‡æœ¬ä¸èƒ½ä¸ºç©º");

        // å‘é€è¯·æ±‚
        await sendRequestWithXMLHttpRequest(siteUrl, token, content);
        PopClip.showText("âœ“ å‘é€æˆåŠŸ");
    } catch (error) {
        handleRequestError(error);
    }
}

// ä½¿ç”¨ XMLHttpRequest å®ç°ç½‘ç»œè¯·æ±‚
function sendRequestWithXMLHttpRequest(siteUrl, token, content) {
    return new Promise((resolve, reject) => {
        const xhr = new XMLHttpRequest();
        const url = `${siteUrl}/api/token/messages`;

        xhr.open("POST", url, true);
        xhr.setRequestHeader("Content-Type", "application/json");
        xhr.setRequestHeader("Authorization", `Bearer ${token}`);

        xhr.timeout = 10000; // è®¾ç½®è¶…æ—¶æ—¶é—´ï¼ˆ10ç§’ï¼‰
        
        // è®¾ç½®å›è°ƒå‡½æ•°
        xhr.onreadystatechange = () => {
            if (xhr.readyState === XMLHttpRequest.DONE) {
                if (xhr.status >= 200 && xhr.status < 300) {
                    resolve(xhr.responseText);
                } else {
                    let errorMsg = `è¯·æ±‚å¤±è´¥ (${xhr.status})`;
                    try {
                        const data = JSON.parse(xhr.responseText);
                        errorMsg = data.message || errorMsg;
                    } catch {}
                    reject(new Error(errorMsg));
                }
            }
        };

        // å¤„ç†ç½‘ç»œé”™è¯¯
        xhr.onerror = () => reject(new Error("ç½‘ç»œé”™è¯¯"));
        
        // å¤„ç†è¶…æ—¶é”™è¯¯
        xhr.ontimeout = () => reject(new Error("è¯·æ±‚è¶…æ—¶"));

        try {
            // å‘é€è¯·æ±‚
            const payload = JSON.stringify({
                content: `#Popclip\n${content}`,
                type: "text"
            });
            xhr.send(payload);
        } catch (error) {
            reject(new Error("è¯·æ±‚å‘é€å¤±è´¥: " + error.message));
        }
    });
}

// é”™è¯¯å¤„ç†
function handleRequestError(error) {
    console.error("è¯·æ±‚é”™è¯¯:", error);
    
    const errorMap = {
        "Failed to fetch": "æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨",
        "aborted": "è¯·æ±‚è¶…æ—¶",
        "ç½‘ç»œé”™è¯¯": "ç½‘ç»œé”™è¯¯",
        "401": "è®¤è¯å¤±è´¥ï¼Œè¯·æ£€æŸ¥Token",
        "404": "APIåœ°å€ä¸å­˜åœ¨"
    };

    const message = Object.entries(errorMap).find(([key]) => 
        error.message.includes(key)
    )?.[1] || `è¯·æ±‚é”™è¯¯: ${error.message.split('\n')[0].slice(0, 50)}`;

    PopClip.showText(`âŒ ${message}`);
}

exports.actions = [{
    title: "å‘é€è‡³è¯´è¯´ç¬”è®°",
    code: sendToShuo,
    icon: "square filled è¯´"
}];

```

</details>

<summary><h2>âœ… Webç»„ä»¶ç¤ºä¾‹ã€ç‚¹å‡»æŸ¥çœ‹ã€‘</h2></summary>

å¦‚æœä½ æƒ³å°†å†…å®¹ä½œä¸ºè¯´è¯´åµŒå…¥æˆ–ç»“åˆåˆ°ä½ çš„ç½‘ç«™ã€åšå®¢å¯ä»¥å‚è€ƒ

è¯´æ˜ï¼šhostä¸ºç«™ç‚¹åœ°å€ï¼Œlimitä¸ºæ¯é¡µå†…å®¹æ•°é‡ï¼ŒdomIdä¸ºå®¹å™¨åï¼Œä¸‹é¢çš„ä»£ç å±•ç¤ºäº†ä½¿ç”¨jsæ¥è¯·æ±‚æ•°æ®å†…å®¹åˆ°å‰ç«¯å¹¶æ¸²æŸ“å¤„ç†çš„åŸºæœ¬æ¡†æ¶ï¼Œå…¶ä½™éœ€è¦ä½ è‡ªå·±å†ä¸°å¯Œcssæ ·å¼å’Œä½ è‡ªå·±çš„é¡µé¢

htmlå‰ç«¯ï¼š

```
<link rel="stylesheet" href="./assets/css/note.css">
<!-- noteå®¹å™¨éƒ¨åˆ† -->
        <div id="note" class="note page active">
        <div class="note-container">
        <div class="loading-wrapper" style="text-align: center; padding: 20px;">
        åŠ è½½ä¸­...
        </div>
        </div>
 <script type="text/javascript">
    var note = {
        host: 'https://note.noisework.cn', //è¯·ä¿®æ”¹ä¸ºä½ è‡ªå·±çš„ç«™ç‚¹åœ°å€
        limit: '10',
        domId: '#note'
    }
</script>
<!-- æ·»åŠ note.jsè„šæœ¬ -->
<script type="text/javascript" src="./assets/js/note.js"></script>
```

note.js

```js
// Note says content loading script
document.addEventListener('DOMContentLoaded', function() {
    // get parameters from global configuration
    const config = window.note || {
        host: 'https://note.noisework.cn',
        limit: '10',
        domId: '#note'
    };
    
    // ä¿®æ”¹å®¹å™¨é€‰æ‹©å™¨
    const container = document.querySelector('#note .note-container');
    let currentPage = 1;
    let isLoading = false;
    let hasMore = true;
    
    // create load more button
    const loadMoreBtn = document.createElement('button');
    loadMoreBtn.id = 'load-more-note';
    loadMoreBtn.className = 'load-more';
    loadMoreBtn.textContent = 'åŠ è½½æ›´å¤š';
    loadMoreBtn.style.display = 'none';
    loadMoreBtn.addEventListener('click', loadMoreContent);
    
    // create already loaded all prompt
    const loadedAll = document.createElement('div');
    loadedAll.id = 'loaded-all-note';
    loadedAll.className = 'loaded-all';
    loadedAll.textContent = 'å·²åŠ è½½å…¨éƒ¨';
    loadedAll.style.display = 'none';
    
    container.appendChild(loadMoreBtn);
    container.appendChild(loadedAll);
    
    // initial load
    loadInitialContent();
    
    async function loadInitialContent() {
        try {
            console.log(`è¯·æ±‚URL: ${config.host}/api/messages/page?page=${currentPage}&pageSize=${config.limit}`);
            const response = await fetch(`${config.host}/api/messages/page?page=${currentPage}&pageSize=${config.limit}`);
            
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            
            const result = await response.json();
            console.log('APIå“åº”æ•°æ®:', result);
            
            // ä¿®æ”¹ä¸ºæ£€æŸ¥result.data.items
            if (result && result.code === 1 && result.data && result.data.items && Array.isArray(result.data.items)) {
                const sortedData = result.data.items.sort((a, b) => 
                    new Date(b.created_at) - new Date(a.created_at)
                );
                renderMessages(sortedData);
                
                if (result.data.items.length >= config.limit) {
                    loadMoreBtn.style.display = 'block';
                } else {
                    loadedAll.style.display = 'block';
                    hasMore = false;
                }
            } else {
                container.querySelector('.loading-wrapper').textContent = 'æš‚æ— å†…å®¹';
                hasMore = false;
            }
        } catch (error) {
            console.error('åŠ è½½å†…å®¹å¤±è´¥:', error);
            container.querySelector('.loading-wrapper').textContent = 'åŠ è½½å¤±è´¥ï¼Œè¯·åˆ·æ–°é‡è¯•';
        }
    }
    
    async function loadMoreContent() {
        if (isLoading || !hasMore) return;
        
        isLoading = true;
        loadMoreBtn.textContent = 'åŠ è½½ä¸­...';
        currentPage++;
        
        try {
            const response = await fetch(`${config.host}/api/messages/page?page=${currentPage}&pageSize=${config.limit}`);
            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }
            const result = await response.json();
            
            // åŒæ ·ä¿®æ”¹ä¸ºæ£€æŸ¥result.data.items
            if (result && result.code === 1 && result.data && result.data.items && Array.isArray(result.data.items)) {
                const sortedData = result.data.items.sort((a, b) => 
                    new Date(b.created_at) - new Date(a.created_at)
                );
                renderMessages(sortedData);
                
                if (result.data.items.length < config.limit) {
                    loadMoreBtn.style.display = 'none';
                    loadedAll.style.display = 'block';
                    hasMore = false;
                }
            } else {
                loadMoreBtn.style.display = 'none';
                loadedAll.style.display = 'block';
                hasMore = false;
            }
        } catch (error) {
            console.error('åŠ è½½æ›´å¤šå†…å®¹å¤±è´¥:', error);
            currentPage--;
        } finally {
            isLoading = false;
            loadMoreBtn.textContent = 'åŠ è½½æ›´å¤š';
        }
    }
    
    function renderMessages(messages) {
        const loadingWrapper = container.querySelector('.loading-wrapper');
        if (loadingWrapper) {
            loadingWrapper.style.display = 'none';
        }
        
        messages.forEach(message => {
            const messageElement = createMessageElement(message);
            container.insertBefore(messageElement, loadMoreBtn);
        });
    }
    
    function createMessageElement(message) {
        const messageDiv = document.createElement('div');
        messageDiv.className = 'rssmergecard';
        
        const contentDiv = document.createElement('div');
        contentDiv.className = 'rssmergecard-content';
        
        const title = document.createElement('h3');
        title.className = 'rssmergecard-title';
        title.textContent = message.username || 'åŒ¿åç”¨æˆ·';
        
        const description = document.createElement('div');
        description.className = 'rssmergecard-description';
        
        // è§£æMarkdownå†…å®¹å’Œç‰¹æ®Šé“¾æ¥
        let processedContent = message.content || 'æ— å†…å®¹';
        processedContent = parseMarkdown(processedContent);
        processedContent = parseSpecialLinks(processedContent);
        description.innerHTML = processedContent;
        
        // å¦‚æœæœ‰å›¾ç‰‡åˆ™æ·»åŠ å›¾ç‰‡
        if (message.image_url) {
            const img = document.createElement('img');
            img.src = message.image_url.startsWith('http') ? message.image_url : config.host + message.image_url;
            img.style.maxWidth = '100%';
            img.style.borderRadius = '6px';
            img.style.margin = '10px 0';
            description.appendChild(img);
        }
        
        const metaDiv = document.createElement('div');
        metaDiv.className = 'rssmergecard-meta';
        
        const timeSpan = document.createElement('span');
        timeSpan.className = 'rssmergecard-time';
        timeSpan.textContent = formatDate(message.created_at);
        
        metaDiv.appendChild(timeSpan);
        contentDiv.appendChild(title);
        contentDiv.appendChild(description);
        contentDiv.appendChild(metaDiv);
        messageDiv.appendChild(contentDiv);
        
        return messageDiv;
    }
    
    function parseMarkdown(content) {
        // å¤„ç†æ ‡é¢˜
        content = content.replace(/^#\s(.+)$/gm, '<h1>$1</h1>');
        content = content.replace(/^##\s(.+)$/gm, '<h2>$1</h2>');
        content = content.replace(/^###\s(.+)$/gm, '<h3>$1</h3>');
        
        // å¤„ç†å›¾ç‰‡ ![alt](url)
        content = content.replace(/!\[([^\]]*)\]\(([^)]+)\)/g, '<img src="$2" alt="$1" style="max-width:100%;border-radius:6px;margin:10px 0;">');
        
        // å¤„ç†é“¾æ¥ [text](url)
        content = content.replace(/\[([^\]]+)\]\(([^)]+)\)/g, '<a href="$2" target="_blank">$1</a>');
        
        // å¤„ç†ç²—ä½“ **text**
        content = content.replace(/\*\*([^*]+)\*\*/g, '<strong>$1</strong>');
        
        // å¤„ç†æ–œä½“ *text*
        content = content.replace(/\*([^*]+)\*/g, '<em>$1</em>');
        
        // å¤„ç†ä»£ç å— `code`
        content = content.replace(/`([^`]+)`/g, '<code>$1</code>');
        
        return content;
    }
    
    function parseSpecialLinks(content) {
        // å®šä¹‰å„ç§å¹³å°çš„æ­£åˆ™è¡¨è¾¾å¼
        const BILIBILI_REG = /https:\/\/www\.bilibili\.com\/video\/((av[\d]{1,10})|(BV[\w]{10}))\/?/g;
        const BILIBILI_A_TAG_REG = /<a\shref="https:\/\/www\.bilibili\.com\/video\/((av[\d]{1,10})|(BV[\w]{10}))\/?">.*<\/a>/g;
        const QQMUSIC_REG = /<a\shref="https\:\/\/y\.qq\.com\/.*(\/[0-9a-zA-Z]+)(\.html)?".*?>.*?<\/a>/g;
        const QQVIDEO_REG = /<a\shref="https:\/\/v\.qq\.com\/.*\/([a-zA-Z0-9]+)\.html".*?>.*?<\/a>/g;
        const SPOTIFY_REG = /<a\shref="https:\/\/open\.spotify\.com\/(track|album)\/([\s\S]+)".*?>.*?<\/a>/g;
        const YOUKU_REG = /<a\shref="https:\/\/v\.youku\.com\/.*\/id_([a-zA-Z0-9=]+)\.html".*?>.*<\/a>/g;
        const YOUTUBE_REG = /<a\shref="https:\/\/(www\.youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})".*?>.*<\/a>/g;
        const NETEASE_MUSIC_REG = /<a\shref="https?:\/\/music\.163\.com\/.*?id=(\d+)<\/a>/g;
    
        // è§£æå„ç§é“¾æ¥
        return content
            .replace(BILIBILI_REG, "<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%;'></iframe></div>")
            .replace(YOUTUBE_REG, "<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>")
            .replace(NETEASE_MUSIC_REG, "<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>")
            .replace(QQMUSIC_REG, "<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>")
            .replace(QQVIDEO_REG, "<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>")
            .replace(SPOTIFY_REG, "<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>")
            .replace(YOUKU_REG, "<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>");
    }
    
    function formatDate(dateString) {
        if (!dateString) return 'æœªçŸ¥æ—¶é—´';
        return new Date(dateString).toLocaleString();
    }
});
```

ç¤ºä¾‹note.css

```
/* åŸºç¡€å¡ç‰‡æ ·å¼ */
.rssmergecard {
    background: #fff;
    border-radius: 8px;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    margin-bottom: 20px;
    padding: 20px;
    transition: all 0.3s ease;
}

.rssmergecard:hover {
    box-shadow: 0 5px 15px rgba(0,0,0,0.2);
}

/* æ ‡é¢˜æ ·å¼ */
.rssmergecard-title {
    color: #333;
    font-size: 18px;
    margin: 0 0 10px 0;
}

/* å†…å®¹æ ·å¼ - æ”¯æŒMarkdownæ¸²æŸ“ */
.rssmergecard-description {
    color: #555;
    line-height: 1.6;
    font-size: 15px;
}

.rssmergecard-description p {
    margin: 10px 0;
}

.rssmergecard-description a {
    color: #3498db;
    text-decoration: none;
}

.rssmergecard-description a:hover {
    text-decoration: underline;
}

.rssmergecard-description img {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
}

/* å…ƒä¿¡æ¯æ ·å¼ */
.rssmergecard-meta {
    margin-top: 15px;
    font-size: 13px;
    color: #999;
}

/* åŠ è½½æ›´å¤šæŒ‰é’®æ ·å¼ */
.load-more {
    background: #3498db;
    color: white;
    border: none;
    padding: 10px 20px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    margin: 20px auto;
    display: block;
}

.load-more:hover {
    background: #2980b9;
}

.loaded-all {
    text-align: center;
    color: #999;
    font-size: 14px;
    margin: 20px 0;
}

/* ç‰¹æ®Šé“¾æ¥å¡ç‰‡æ ·å¼ */
.media-card {
    background: #f8f9fa;
    border-left: 4px solid #3498db;
    padding: 15px;
    margin: 15px 0;
    border-radius: 0 4px 4px 0;
}

.media-card-title {
    font-weight: bold;
    margin-bottom: 5px;
}

.video-wrapper {
    position: relative;
    padding-bottom: 56.25%; /* 16:9 */
    height: 0;
    margin: 15px 0;
}

.video-wrapper iframe {
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    border-radius: 8px;
}

.music-wrapper, .spotify-wrapper {
    margin: 15px 0;
    border-radius: 8px;
    overflow: hidden;
    min-height: 86px; /* ç¡®ä¿æœ‰è¶³å¤Ÿé«˜åº¦æ˜¾ç¤ºæ’­æ”¾å™¨ */
}

.music-wrapper meting-js {
    width: 100%;
    height: 86px;
}
```

</details>

## é—®é¢˜ğŸ™‹

æ•°æ®åº“å¯ä»¥ç›´æ¥è¿ç§»å—

1ã€ç›´æ¥ä¸Šä¼ è‡³éƒ¨ç½²æ—¶æŒ‚è½½çš„è·¯å¾„ä¸­ï¼Œé‡æ–°å¯ç”¨ï¼Œæˆ–è€…åœ¨å®¹å™¨æ–‡ä»¶å¤¹/app/data/noise.dbç›´æ¥æ›¿æ¢å³å¯

2ã€ä½¿ç”¨åå°æ•°æ®åº“ç®¡ç†å¤‡ä»½åŠŸèƒ½ï¼Œæ”¯æŒä¸€é”®ä¸‹è½½ã€ä¸Šä¼ 

â€‹    æ•°æ®åº“æ–‡ä»¶ä¸‹è½½ä¸ºzipæ ¼å¼ï¼Œä¸Šä¼ ä¹Ÿå¿…é¡»ä¸ºzipï¼Œæœ¬åœ°æ•°æ®åº“æ¢å¤åŒ…ä¸­å¿…é¡»æœ‰noise.dbæ–‡ä»¶

## å…³äºé­”æ”¹æŒ‡å—ğŸŒˆ

ğŸ‘‰å¦‚ä½•è‡ªå®šä¹‰åŒ–å‰ç«¯æ•°æ®åæ·»åŠ åˆ°æ•°æ®åº“ï¼Ÿ

éœ€è¦åœ¨setting.goã€migrate.goã€models.goã€controllers.goåŒæ—¶å†™å…¥å‰ç«¯å‚æ•°çš„åç«¯å®šä¹‰ï¼Œå¹¶ä¿®æ”¹å‰ç«¯å‚æ•°ä¿¡æ¯ä¸ºåç«¯å¯è¯»å–çš„å‚æ•°ï¼Œå…¶ä¸­controllers.goä¸ºæ§åˆ¶å™¨

- database.go ç”¨äºæ•°æ®åº“è¿æ¥ç®¡ç†
- migrate.go ç”¨äºæ•°æ®åº“è¿ç§»å’Œæ•°æ®åˆå§‹åŒ–

ğŸ‘‰å‰ç«¯åŸºæœ¬åœ¨webç›®å½•ä¸‹ï¼Œç›®å‰æ¨¡ç‰ˆæ–‡ä»¶ä¸ºcomponentsç›®å½•æ–‡ä»¶ï¼Œpagesä¸‹index.vueä¸ºçˆ¶çº§æ¨¡ç‰ˆ

ğŸ‘‰å»ºè®®ï¼šä¸è¦å’Œæˆ‘ä¸€æ ·åœ¨åŒä¸€ä¸ªæ–‡ä»¶é‡Œä¿®æ”¹æ·»åŠ ï¼Œé€ æˆä¸€ä¸ªæ–‡ä»¶ä¸Šåƒè¡Œä»£ç ...è¯·å°½é‡ä½¿ç”¨çˆ¶å­å±‚çº§æ¥æ·»åŠ ä»£ç 

## To do

- [x] å¡ç‰‡ç”Ÿæˆçš„ç¾åŒ–
- [x] ä¼˜åŒ–ç¼–è¾‘å™¨
- [x] å¢åŠ å‘å¸ƒçƒ­åŠ›å›¾ç»„ä»¶
- [x] åŠ å…¥æœç´¢åŠŸèƒ½
- [x] postè¯·æ±‚å‘å¸ƒå†…å®¹åˆ°ç«™å†…
- [x] åå°å’Œå‰ç«¯æ•°æ®çš„åŒ¹é…å®Œå–„
- [x] åŠ å…¥æ ‡ç­¾è·¯ç”±åŠç»„ä»¶
- [x] åŠ å…¥ä¸€é”®æ¨é€
- [ ] å…¶å®ƒç»„ä»¶çš„æ·»åŠ 

## è‡´è°¢

[lin-snow](https://github.com/lin-snow)

[Trae](https://www.trae.ai/home)

---

> [!CAUTION]
>
> æœ¬ç‰ˆæœ¬æ˜¯åœ¨åŸç‰ˆæ—§ç‰ˆæœ¬åŸºç¡€ä¸Šè¿›è¡Œæ”¹è¿›ï¼Œä¸ä¿è¯å…¼å®¹åŸç‰ˆï¼Œä½†ä¼šè¿›è¡Œä¼˜åŒ–ï¼Œå‡ºäºå¯¹åŸç‰ˆçš„å°Šé‡å’Œä¿æŠ¤ï¼Œæœ¬ç‰ˆä»…åœ¨å®Œå–„åˆ°ä¸€å®šç¨‹åº¦æ‰ä¼šå¼€æ”¾å¼€æº
